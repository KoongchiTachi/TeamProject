<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mappers.bid-mapper">

	<insert id="insertBid">
		insert into tbl_bid(bno, m_id, b_price, b_note, pno)
		values(seq_bno.nextval, #{m_id}, #{b_price}, #{b_note}, #{pno})
	</insert>
	
	<select id="bidList" resultType="BidVo">
		select * 
		from (select rownum rnum, a.*
			  from (select m.m_id, p.pno, b.bno, p.p_img, p.p_info, p.p_price, b.b_price, b.b_date, s.s_name
					from tbl_bid b, tbl_product p, tbl_member m, code_state s
					where b.pno = p.pno and p.p_state = s.s_code and m.m_id = b.m_id and m.m_id = #{m_id}) a)
		where rnum between #{startRow} and #{endRow}
	</select>
	
	<select id="getCount" resultType="int">
		select count(*) from tbl_bid
	</select>

</mapper>